25.04.2022

Задача: UV-Madison GI Tract Image Segmentaion
https://www.kaggle.com/competitions/uw-madison-gi-tract-image-segmentation/overview/description

Сегментация изображения желудочно-кишечного тракта. Отслеживание здоровых органов на снимках, чтобы улучшить процедуру лечения рака. Онкологи могут визуализировать ежедневное положение опухоли и кишечника, которе может меняться изо дня в день. При этих сканированиях онкологи-радиологи должны вручную наметить положение жедудка и кишечника чтобы отрегулировать направление рентгеновских лучей и увеличить дозу, доставляемую к опухоли и избежать облучения желудка и кишечника.

Исходные данные - МРТ снимки, взятые у раковых больных - 1-5 МРТ сессий в разные дни лучевой терапии.

Метрика состоит из двух компонент
1. Коэффициент Серенсена-Дайса DSC = 2 |X П Y|/(|X|+|Y|) - оценивает сходство двух множеств X и Y.  Если оба пусты, то DSC = 1. X - это предсказанное множество пикселов, Y - истинное. В других терминах DSC = 2 TruePositive / (2 TruePostive + FalsePositive + FalseNegative). В метрике на Public Leaderboard учитывает среднее значение DSC по всем изображениям из тестового набора.

2. 3d Hausdorff distance - расстояние Хаусдорффа. Хаусдорфово расстояние (HD) — это метод расчета расстояния между объектами сегментации A и B путем вычисления самой дальней точки на объекте A от ближайшей точки на объекте B. Для трехмерного метода Хаусдорфа мы строим трехмерные объемы, комбинируя каждую двухмерную сегментацию с глубиной среза в качестве Координата Z, а затем находя расстояние Хаусдорфа между ними. (В этом конкурсе глубина среза для всех сканирований установлена равной 1.) Код scipy для Hausdorff здесь https://github.com/scipy/scipy/blob/main/scipy/spatial/_hausdorff.pyx. Ожидаемые/прогнозируемые местоположения пикселей нормализуются по размеру изображения, чтобы получить  оценку в интервале [0,1].

Итоговая метрика  = 0.4 DSC + 0.6 HD

Sample Submission
Файл отправки

Чтобы уменьшить размер файла отправки, наша метрика использует кодирование длин серий для значений пикселей.   Вместо того, чтобы отправлять исчерпывающий список индексов для вашей сегментации, вы будете отправлять пары значений, которые содержат начальную позицию и продолжительность. Например, «1 3» подразумевает начало с пикселя 1 и всего 3 пикселя (1,2,3).

Обратите внимание, что во время кодирования маска должна быть бинарной , то есть маски для всех объектов изображения объединяются в одну большую маску. Значение 0 должно указывать пиксели, которые не маскируются, а значение 1 указывает пиксели, которые маскируются.

Формат соревнования требует список пар, разделенных пробелами. Например, «1 3 10 5» означает, что в маску должны быть включены пиксели 1, 2, 3, 10, 11, 12, 13, 14. Метрика проверяет, что пары отсортированы, положительны, а значения декодированных пикселей не дублируются. Пиксели нумеруются сверху вниз, затем слева направо: 1 — пиксель (1,1), 2 — пиксель (2,1) и т. д.

Файл должен содержать заголовок и иметь следующий формат:

id,class, predicted 
1,large_bowel,1 1 5 1 
1,small_bowel,1 1 
1,stomach,1 1 
2,large_bowel,1 5 2 17 

и т. д.

Структура данных.

В этом конкурсе мы сегментируем клетки органов на изображениях. Обучающие аннотации предоставляются в виде масок в кодировке RLE, а изображения представлены в 16-битном формате PNG в градациях серого.

Каждый случай в этом конкурсе представлен несколькими наборами сканированных срезов (каждый набор идентифицируется по дню проведения сканирования). Некоторые случаи разделены по времени (первые дни находятся в процессе, более поздние дни находятся в стадии тестирования), в то время как некоторые случаи разделены по случаям — весь случай находится в процессе подготовки или тестирования. Целью этого соревнования является возможность обобщать как частично, так и полностью невидимые случаи.

Обратите внимание, что в этом случае тестовый набор полностью невидим. Это примерно 50 случаев с разным количеством дней и срезов, как видно из обучающей выборки.

Тестовый набор в этом конкурсе доступен только после отправки вашего кода. Предоставленный sample_submission.csv в общедоступном наборе пустой заполнитель, который показывает требуемый формат отправки; вы должны выполнить моделирование, перекрестную проверку и т. д., используя обучающий набор, и написать код для обработки отправки непустого образца. Он будет содержать строки с id, class и predicted столбцами, как описано выше.

Когда вы отправляете свой python-ноутбук, ваш код будет выполняться на нескрытом наборе тестов, который имеет тот же формат папки ( <case>/<case_day>/<scans>), что и обучающие данные.

Файлы

train.csv -  идентификаторы и маски для всех обучающих объектов.
sample_submission.csv — образец файла представления в правильном формате.
train — папка с папками случаев/дней, каждая из которых содержит изображения срезов для конкретного случая в данный день.

Обратите внимание, что имена файлов изображений включают 4 числа (например, 276_276_1.63_1.63.png). Эти четыре числа представляют собой высоту/ширину среза (целые числа в пикселях) и расстояние между пикселями по высоте/ширине (с плавающей запятой в миллиметрах). Первые два определяют разрешение слайда. Последние два записывают физический размер каждого пикселя.

Столбцы
id- уникальный идентификатор объекта
class- предсказанный класс для объекта
EncodedPixels - RLE-кодированные пиксели для идентифицированного объекта



